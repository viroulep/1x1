(this.webpackJsonp1x1=this.webpackJsonp1x1||[]).push([[0],{64:function(e,t,n){},65:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),i=n.n(c),r=n(10),o=n.n(r),s=(n(64),n(65),n(66),n(11)),j=n(103),l=n(104),d=n(96),u=n(92),b=n(32),h=n(40),p=n(13),O=function(e,t){var n=t.type,a=t.data;switch(n){case"setState":return a;case"addHistory":return Object(p.a)(Object(p.a)({},e),{},{history:[a].concat(Object(h.a)(e.history))});case"toggleActive":var c=a.name,i=a.teamId;return Object(p.a)(Object(p.a)({},e),{},{teams:Object(p.a)(Object(p.a)({},e.teams),{},Object(b.a)({},i,Object(p.a)(Object(p.a)({},e.teams[i]),{},{people:e.teams[i].people.map((function(e){return e.name===c&&(e.active=!e.active),Object(p.a)({},e)}))})))});default:throw new Error}},f=n(106),m=n(94),x=n(41),v=n(95),g=n(97),y=n(98),w=n(99),S=n(107),k=n(100),C=n(105),T=n(101),N=Object(u.a)((function(e){return{root:{display:"flex",flexDirection:"column"}}})),E=function(e){var t=e.state,n=e.updateState,c=t.teams,i=N();return Object(a.jsx)("div",{className:i.root,children:Object(a.jsxs)(f.a,{children:[Object(a.jsx)(m.a,{children:Object(a.jsx)(x.a,{variant:"h2",children:"Teams"})}),Object(a.jsx)(v.a,{children:Object(a.jsx)(d.a,{container:!0,spacing:2,children:Object.values(c).map((function(e){return Object(a.jsx)(d.a,{item:!0,xs:12,sm:4,md:3,children:Object(a.jsx)(g.a,{variant:"outlined",children:Object(a.jsxs)(y.a,{children:[Object(a.jsx)(x.a,{gutterBottom:!0,variant:"h5",component:"h2",children:e.name}),Object(a.jsx)(w.a,{dense:!0,children:e.people.map((function(t){return Object(a.jsxs)(S.a,{role:void 0,button:!0,onClick:function(){return t.participate&&n({type:"toggleActive",data:{name:t.name,teamId:e.name}})},children:[Object(a.jsx)(k.a,{children:Object(a.jsx)(C.a,{edge:"start",checked:t.active,disabled:!t.participate})}),Object(a.jsx)(T.a,{primary:t.name})]},t.name)}))})]})})},e.name)}))})})]})})},D=n(74),J=Object(u.a)((function(e){return{pairing:{padding:e.spacing(2)}}})),A=function(e){return e?" from team ".concat(e):""},I=function(e){var t=e.map,n=e.a,c=e.b;return Object(a.jsxs)("div",{children:[n,A(t[n]),", with ",c,A(t[c])]})},B=function(e){var t=e.history,n=e.peopleToTeam,c=J();return Object(a.jsx)(d.a,{container:!0,spacing:2,children:t.map((function(e){var t=e.date,i=e.pairings,r=e.unpaired;return Object(a.jsxs)(d.a,{item:!0,xs:12,children:[Object(a.jsxs)(x.a,{gutterBottom:!0,variant:"h5",component:"h2",children:["Pairing on ",new Date(t).toUTCString()]}),Object(a.jsx)(D.a,{variant:"outlined",square:!0,className:c.pairing,children:Object(a.jsxs)(x.a,{variant:"body2",component:"div",children:[i.map((function(e){var t=Object(s.a)(e,2),c=t[0],i=t[1];return Object(a.jsx)(I,{a:c,b:i,map:n},"".concat(c,"-").concat(i))})),r.length>0&&Object(a.jsxs)("div",{children:["Not paired: ",r.join(", ")]})]})})]},t)}))})},F=Object(u.a)((function(e){return{root:{display:"flex",flexDirection:"column"},pairing:{padding:e.spacing(2)}}})),M=function(e){var t=e.state,n=F(),c=t.history,i=t.peopleToTeam;return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(f.a,{children:[Object(a.jsx)(m.a,{children:Object(a.jsx)(x.a,{variant:"h2",children:"History"})}),Object(a.jsx)(v.a,{children:Object(a.jsx)(B,{history:c,peopleToTeam:i})})]})})},R=n(102),L=n(48),U=n(49),z=n(50),H=n(51),P=n(52),G=n(44),q=n(15),K=n(53),Q=function(e){Object(H.a)(n,e);var t=Object(P.a)(n);function n(e,a){var c;return Object(U.a)(this,n),(c=t.call(this,a)).default=e,c}return Object(z.a)(n,[{key:"get",value:function(e){return this.has(e)||Object(G.a)(Object(q.a)(n.prototype),"set",this).call(this,e,this.default()),Object(G.a)(Object(q.a)(n.prototype),"get",this).call(this,e)}}]),n}(Object(K.a)(Map)),V=function(e,t,n){var a=[],c=new Map,i=new Q((function(){return new Set}));Object.values(e).forEach((function(e){e.people.forEach((function(e){var t=e.name;e.active&&a.push(t)}))})),n.forEach((function(e){e.pairings.forEach((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];i.get(n).add(a),i.get(a).add(n)}))})),a.forEach((function(n){c.set(n,new Set([].concat(a).filter((function(a){return!i.get(n).has(a)&&!e[t[n]].peopleSet.has(a)}))))}));for(var r=[],o=[],j=function(e){var t,n=Object(L.a)(c.values());try{for(n.s();!(t=n.n()).done;){t.value.delete(e)}}catch(a){n.e(a)}finally{n.f()}},l=function(){a.sort((function(e,t){var n=c.get(e).size,a=c.get(t).size,i=n-a;return n&&a||(i=-i),i}));var e=a.shift();j(e);var t=c.get(e).size?Object(h.a)(c.get(e)):a.filter((function(t){return i.get(e).has(t)}));if(0===t.length)return o.push(e),"continue";var n,s,l=t[(n=0,s=t.length,Math.floor(Math.random()*(s-n)+n))];j(l),r.push([e,l]),a.splice(a.indexOf(l),1)};0!==a.length;)l();return{date:(new Date).toJSON(),pairings:r,unpaired:o}},W=function(e){var t=Object(p.a)({},e),n={};return Object.entries(t.teams).forEach((function(e){var t=Object(s.a)(e,2)[1];t.people.forEach((function(e){e.active=e.participate,n[e.name]=t.name})),t.peopleSet=new Set(t.people.map((function(e){return e.name})))})),t.peopleToTeam=n,t},X=Object(u.a)((function(e){return{root:{display:"flex",flexDirection:"column"}}})),Y=function(e){var t=e.state,n=e.updateState,i=X(),r=t.teams,o=t.history,j=t.peopleToTeam,l=Object(c.useState)(null),u=Object(s.a)(l,2),b=u[0],h=u[1],p=Object(c.useState)(!1),O=Object(s.a)(p,2),f=O[0],m=O[1],v=!!b&&-1!==o.findIndex((function(e){return e.date===b.date})),w=Object(c.useCallback)((function(){var e=JSON.stringify(function(e){for(var t={teams:{},history:e.history},n=0,a=Object.entries(e.teams);n<a.length;n++){var c=Object(s.a)(a[n],2),i=c[0],r=c[1],o=r.name,j=r.people;t.teams[i]={name:o,people:j.map((function(e){return{name:e.name,participate:e.participate}}))}}return t}(t),null,2),n=new Blob([e],{type:"application/json"}),a=window.URL.createObjectURL(n),c=document.createElement("a");c.href=a,c.setAttribute("download","1x1-data.json"),document.body.appendChild(c),c.click()}),[t]);return Object(a.jsx)("div",{className:i.root,children:Object(a.jsx)(g.a,{children:Object(a.jsxs)(y.a,{children:[Object(a.jsx)(x.a,{variant:"h2",children:"Create new pairings"}),Object(a.jsxs)(d.a,{container:!0,direction:"column",spacing:2,children:[Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(x.a,{variant:"body1",component:"div",children:Object(a.jsxs)("ol",{children:[Object(a.jsx)("li",{children:'Go to the "teams" section and unselect the person unavailable.'}),Object(a.jsx)("li",{children:"Create the pairings by clicking the button below"}),Object(a.jsx)("li",{children:"If you are not happy about them, go back to step 2, otherwise proceed with the next step."}),Object(a.jsx)("li",{children:"Copy paste them in a new draft email."}),Object(a.jsx)("li",{children:"Add them to history by clicking the button below."}),Object(a.jsx)("li",{children:"Download the data, and keep them to generate the next pairings."})]})})}),Object(a.jsxs)(d.a,{container:!0,item:!0,spacing:2,children:[Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(R.a,{variant:"contained",color:"primary",onClick:function(){return h(V(r,j,o))},children:"Create the pairings"})}),Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(R.a,{variant:"contained",color:"primary",disabled:!b||v,onClick:function(){n({type:"addHistory",data:b}),m(!0)},children:"Add to history"})}),Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(R.a,{variant:"contained",color:"primary",disabled:!f,onClick:w,children:"Download the data"})})]}),Object(a.jsx)(d.a,{item:!0,children:b&&Object(a.jsx)(B,{peopleToTeam:j,history:[b]})})]})]})})})},Z=function(e){var t=e.updateState,n=Object(c.useRef)(null),i=Object(c.useCallback)((function(e,n){var a=new FileReader;a.onload=function(e){t({type:"setState",data:W(JSON.parse(e.target.result))})},a.readAsText(e.target.files[0])}),[t]);return Object(a.jsx)(g.a,{children:Object(a.jsxs)(y.a,{children:[Object(a.jsx)(x.a,{variant:"h2",children:"1x1"}),Object(a.jsx)(x.a,{variant:"body1",children:"Click the button below to upload a JSON describing the teams and the pairing history."}),Object(a.jsx)("div",{children:Object(a.jsx)(R.a,{variant:"contained",color:"primary",onClick:function(){return n.current.click()},children:"Upload JSON"})}),Object(a.jsx)("input",{type:"file",ref:n,accept:".json",style:{display:"none"},onChange:function(e){return i(e,n)}})]})})},$=Object(u.a)((function(e){return{root:{display:"flex",height:"100vh",flexDirection:"column",marginTop:e.spacing(2)},grow:{flexGrow:1}}})),_=function(){var e=$(),t=Object(c.useReducer)(O,null),n=Object(s.a)(t,2),i=n[0],r=n[1];return Object(a.jsxs)("div",{className:e.root,children:[Object(a.jsx)(j.a,{}),Object(a.jsx)(l.a,{children:i?Object(a.jsxs)(d.a,{container:!0,direction:"column",spacing:2,children:[Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(Y,{state:i,updateState:r})}),Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(E,{state:i,updateState:r})}),Object(a.jsx)(d.a,{item:!0,children:Object(a.jsx)(M,{state:i})})]}):Object(a.jsx)(Z,{updateState:r})})]})};var ee=function(){return Object(a.jsx)(_,{})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,109)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};o.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(ee,{})}),document.getElementById("root")),te()}},[[73,1,2]]]);
//# sourceMappingURL=main.565a0b0b.chunk.js.map